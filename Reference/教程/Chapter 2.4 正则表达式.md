# Chapter 2.4 正则表达式 



[TOC]

----

## 题目

```php
//核心代码 
$key='flag{********************************}'; 
$Regular= preg_match("/zkaq.*key.{2,9}:\/.*\/(key*key)/i", trim($_GET["id"]), $match); 
if( $Regular ){  
  die('key: '.$key); 
}  
```

## 解题思路

 1. 本题注重于考察正则表达式的运用，使用`preg_match()`函数进行正则匹配，已知此函数包含三个参数：

    ```php
    preg_match(正则表达式,匹配字符串,置入数组)
    ```

    在本题中我们可以分析出本题是调用`trim()`函数使用全局变量`id`进行GET传参，所以`id`的赋值语句就是我们输入正则表达式的位置。
    
 2. 本题涉及到的正则表达式中的匹配语法分别有：

    | 语法  | 含义                                                 |
    | :---: | :--------------------------------------------------- |
    |   .   | 通配符。匹配区间**任意字符**                         |
    |   *   | 匹配0次或多次。跟随在"."后可代表**限制任意字符个数** |
    |   \   | 转义字符。多用于将控制字符加入匹配字符串             |
    | {x,y} | 限定符。代表限定匹配个数的区间                       |
    |  ()   | 代表括号内为一个整体。                               |
    |  /i   | 不区分大小写                                         |


## 解题过程

1. "**/**" 为正则表达式起始，之后的`zkaq`为固定字符串

2. " **.*** " 代表**匹配任意字符0次或多次**，可以输入`123`占位

3. "**key**" 为固定字符串

4. "**.{2,9}**" 表示**任意字符可以出现2~9次**，可以输入`123`占位

5. " **:** " 为固定字符

6. " **\/** " 中,`\`为**转义字符**，将其后的`/`加入固定字符串

7. " **.*** " 代表匹配任意字符0次或多次，可以输入`123`占位

8. " **\/** " 中,`\`为转义字符，将其后的`/`加入固定字符串

9. "**(key*key)**" 代表括号内`key(n)key`为**整体**,其中(n)代表前一个`key`可重复零次到多次

10. "**/i**" 中`/`代表正则表达式终止，修饰符`i`代表之前内容**不区分大小写**

11. 最后得出匹配的正则表达式结果：

    ```php
    zkaq123key123:/123/keykeykey
    ```

12. 赋值给`id`变量：`http://59.63.200.79:8010/re/?id=zkaq123key123:/123/keykeykey`,通过`die`函数返回正确结果：

    

## 启发与思考

1. 通配符"."在没有"**{}**"或" ***** "限制的情况下**仅能匹配一位**
2. 关键字" ***** "匹配内容是到**上一个关键字**开始的
3. 转义字符本身的转义可以使用"\\\\"
4. 限定符"**{}**"被匹配时，默认匹配限制内的**最高次数**
5. 善用" **()** "防止关键字不明确

