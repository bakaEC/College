# Chapter 6.4 - CSRF

[TOC]

## 0x00 原理

> **跨站请求伪造**（Cross-site request forgery），也被称为 **one-click attack** 或者 **session riding**，通常缩写为 **CSRF** 或者 **XSRF**， 是一种挟制用户在当前已登录的Web应用程序上执行非本意的操作的攻击方法。跟跨网站XSS相比，**XSS** 利用的是用户对指定网站的信任，CSRF 利用的是网站对用户网页浏览器的信任。

### CSRF的攻击流程

1. **用户**：登录被信任**网站A**
2. **网站A**：验证通过，保留用户**Cookie**
3. **用户**：在不关闭**网站A**会话情况下进入预备好的CSRF**网页B**
4. **网页B**：通过Js指定用户携带`传参信息`访问**网站A**
5. **网站A**：验证用户保留**Cookie**，接受用户`传参信息`

> 由此可见，CSRF便是引导浏览器使用用户的Cookie模拟用户传参。

### 常见的CSRF类型

**GET**类型：通过地址栏的GET传参伪造HTTP请求，如

```
http://ABC.xyz/index.php?id=12
```

实际运用：

```
<img src=http://ABC.xyz/index.php?id=12 />
```

**POST**类型：通常通过表单提交POST请求，如

```html
<html>
  <!-- generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <!-- 指定传参URL及方法 -->
  	<form action="#URL" method="POST">
      <input type="hidden" name="action" value="send" />
      <input type="hidden" name="comtype" value="comments" x
     <!-- 显示按钮提交 -->	
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
```



## 0x01 渗透思路

## 0x02 渗透过程

## 0x03 思考与要点

